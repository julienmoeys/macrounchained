<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Run batch MACRO and MACRO In FOCUS simulations for sets of substance-properties and application patterns, including metabolites (Nth order) • macrounchained</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Run batch MACRO and MACRO In FOCUS simulations for sets of substance-properties and application patterns, including metabolites (Nth order)">
<meta property="og:description" content="Run batch MACRO and MACRO In FOCUS simulations for sets of substance-properties and application patterns, including metabolites (Nth order)">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">macrounchained</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.13.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/macrounchainedfocusgw-manual.html">Running MACROInFOCUS-like groundwater simulations with macrounchainedFocusGW</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/julienmoeys/macrounchained">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">

<p><a href="https://www.r-project.org/" title="The R Project for Statistical Computing">R</a> package for <strong>batch simulation of substance properties and application patterns</strong> with <a href="https://www.slu.se/en/Collaborative-Centres-and-Projects/centre-for-chemical-pesticides-ckb1/models/macro-52/" title="MACRO 5.2 (SLU/CKB)">MACRO</a>, a model of water flow and solute transport in macroporous soil, or with the <strong>groundwater scenario</strong> of its regulatory variant <a href="https://esdac.jrc.ec.europa.eu/projects/macro" title="MACRO In FOCUS (FOCUS DG SANTE)">MACRO In FOCUS</a>. The package makes it possible to simulate <strong>Nth-order metabolites</strong>, including <strong><a href="https://github.com/julienmoeys/macrounchained/blob/master/inst/more_tests/test_GW_10_multiple-paths.svg" title="Figure illustrating multiple transformation pathways">metabolites that are the degradation products of several substances</a></strong> and cases where <strong>several active substances give rise to the same metabolite</strong>. The substance properties and application patterns that can be modified are currently those relevant for the groundwater scenario of MACRO In FOCUS.</p>
<ul>
<li><p><strong>Development status</strong>: pre-release. Do not use for production purpose, as the interface may still evolve if needed, and some bugs may have come unnoticed despite all the tests.</p></li>
<li><p><strong>General information</strong>: See <a href="https://github.com/julienmoeys/macrounchained/blob/master/NEWS" title="macrounchained NEWS-file">DESCRIPTION</a> (including author(s), package-version, minimum R version required, …).</p></li>
<li><p><strong>Change log</strong>: See <a href="https://github.com/julienmoeys/macrounchained/blob/master/NEWS" title="macrounchained NEWS-file">NEWS</a>.</p></li>
<li><p><strong>Operating system</strong>: <code>macrounchained</code> will only work on Windows, because MACRO is a Windows-only program.</p></li>
<li><p><strong>License</strong>: MIT License. See <a href="https://github.com/julienmoeys/macrounchained/blob/master/LICENSE" title="macrounchained LICENSE-file">LICENSE</a>.</p></li>
<li><p>Either MACRO 5.2 or MACRO In FOCUS 5.5.4 or both need to be installed for using <code>macrounchained</code> (see below).</p></li>
</ul>
<div id="features" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#features" class="anchor"></a>Features</h1></div>
<ul>
<li><p>MACRO In FOCUS groundwater users just need to use one R command, <code><a href="reference/macrounchainedFocusGW_ui.html">macrounchained::macrounchainedFocusGW_ui()</a></code>. The command starts a text user interface that allows the users to obtain a copy of example Excel-files for the input-parameters, or to run MACRO In FOCUS simulations after importing input parameters from an Excel-file they have prepared. It is possible to include multiple scenario, crops and substance parameters sets (with or without metabolites). It is also possible to simulate several applications per year and applications every other or every third year. The scenario currently included as Châteaudun, the three Swedish scenario (Näsbygård, Önnestad and Krusenberg), and the two Norwegian scenario (Heia and Rustad).</p></li>
<li><p>MACRO users need in the first place to export a template <code>.par</code>-file (a text file containing the parameters for a MACRO simulation) from MACRO, and will use that template as an input for <code>macrounchained</code> to modify the substance properties and application patterns (doses and application dates). All other parameters such as those concerting the soil properties, the climate, the crop or the number of applications cannot be modified by <code>macrounchained</code>. MACRO users may just use <code>macrounchained</code> to run MACRO simulations and analyse the results separately, or use their own R functions to analyse and summarise simulation results ‘on the fly’. An example for MACRO 5.2 is available here <a href="https://github.com/julienmoeys/macrounchained/blob/master/inst/more_tests/test_GW_09_macro.r" class="uri">https://github.com/julienmoeys/macrounchained/blob/master/inst/more_tests/test_GW_09_macro.r</a></p></li>
<li><p>Several sets of substance properties can be simulated in the same batch (up to 998 sets per batch). The sets of substance properties don’t need to be related.</p></li>
<li><p>For MACRO users, several <code>.par</code>-file templates can be used in the same batch of simulations.</p></li>
<li><p><strong>Nth-order metabolites</strong> can be simulated (only limited by the total number of simulations) and several degradation products can be simulated for the same parent substance (also limited by the total number of simulations), in the same batch. It also possible to simulate <a href="https://github.com/julienmoeys/macrounchained/blob/master/inst/more_tests/test_GW_10_multiple-paths.svg" title="Figure illustrating multiple transformation pathways">metabolites that are the degradation product of several substances</a>. The parent substances can be two or more metabolites and / or two or more active substances. The so called ‘intermediate simulations’ are handled automatically by the package.</p></li>
<li><p>Two higher order functions are provided: <code><a href="reference/macrounchained-methods.html">macrounchained()</a></code> and <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code>. The first is a generic functions, the workhorse of this package, while the second is designed for MACRO In FOCUS groundwater simulations. <code><a href="reference/macrounchainedFocusGW_ui.html">macrounchained::macrounchainedFocusGW_ui()</a></code> is a simple text interface for <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code>.</p></li>
<li><p><code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code> analyses on-the-fly the simulation results and provides the user with a summary of the results, in a similar fashion as fashion as standard <strong>MACRO In FOCUS groundwater</strong> simulations.</p></li>
<li><p>Currently only tested on <strong>MACRO In FOCUS 5.5.4</strong>.</p></li>
<li><p>The results of <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code> have been successfully <strong>tested against the results of the “version control” of MACRO In FOCUS 5.5.4</strong>, and give the same PECgw for all the simulations included in the version control. The function has also been successfully tested against the results of MACRO In FOCUS 5.5.4 for other cases (two application per year; two years interval between applications; Swedish and Norwegian scemario). The tests are “build-in” the package, and they can be run each time an important change is made to the package. The test results can be checked here: <a href="https://github.com/julienmoeys/macrounchained/tree/master/inst/more_tests" class="uri">https://github.com/julienmoeys/macrounchained/tree/master/inst/more_tests</a> See also the “Benchmarks” section below.</p></li>
<li><p>As the interface of MACRO In FOCUS only allow the parametrization of 1st-order metabolites, the package has only been tested for 1st-order metabolites. Results of 2nd-order metabolites have not been compared with a reference value, because of the lack of a public benchmark.</p></li>
<li><p><code><a href="reference/macrounchained-methods.html">macrounchained()</a></code> and <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code> output an <strong>operation log</strong> informing the users of the operations being performed. <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code> also output a summary of the simulation results (including the PECgw) in the operation log, as well as in separate files.</p></li>
<li><p><code><a href="reference/macrounchained-methods.html">macrounchained()</a></code> and <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code> produce a <strong><code>tar.gz</code> archive</strong> containing all the relevant input and output files of the simulation batch. This can be used as an archive by the user.</p></li>
<li><p>The packages do not include any MACRO executable, and instead use an existing MACRO or MACRO In FOCUS installation. The package does not include any climate files for the Swedish and Norwegian scenario. The package does not make use of MACRO In FOCUS Access databases.</p></li>
<li><p>Extensive traceability, with MACRO-version, packages-versions and revision (i.e. a machine generated code linking the package to the code version control system), but also with MD5 checksum for the packages and MACRO-files, reported to the user, so that it is in principle possible to check if a simulation was performed with an official release of the packages or of the MACRO executable, or not.</p></li>
</ul>
</div>
<div id="how-it-works" class="section level1">
<h1 class="hasAnchor">
<a href="#how-it-works" class="anchor"></a>How it works</h1>
<p><code>macrounchained</code> is an alternative interface to MACRO 5.2 or MACRO In FOCUS 5.5.4. It does not require any modification of the core models. It creates parameter files (<code>.par</code>-files) that are used by MACRO or MACRO In FOCUS, via the tool <code>exeparfile.exe</code>. The tool uses a template <code>.par</code>-file, and modifies the parameters related to the substance properties, the application date, the applied dose and (for MACRO In FOCUS) the number of years interval between application years. While MACRO users need to provide one or several template <code>.par</code>-files of their choice, via <code><a href="reference/macrounchained-methods.html">macrounchained()</a></code>, MACRO In FOCUS do not need template <code>.par</code>-files, as these are included in the tool for each groundwater scenario (but not surface water scenario), via <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code> or <code><a href="reference/macrounchainedFocusGW_ui.html">macrounchainedFocusGW_ui()</a></code>. The tool also includes a database of crop parameters for each groundwater scenario, and these parameters are set at the same time as substance parameters. MACRO In FOCUS users just need to specify the name of the scenario and the name of the crop.</p>
<p>Four types of simulations can be run:</p>
<ul>
<li><p>Active substance, that is, the substance that is applied on the field. This is the ‘top parent’.</p></li>
<li><p>Intermediate simulation for an active substance (see below).</p></li>
<li><p>Metabolite, that is a substance that is formed from the degradation of one or several other substances. The parent-substance can be active substances or metabolites.</p></li>
<li><p>Intermediate simulation for a metabolite (see below).</p></li>
</ul>
<p>The algorithm in <code>macrounchained</code> is generic, in the sense that there is no limitation to the order of the metabolite (primary, secondary, ternary, etc.) or to the number of metabolites formed from the degradation of a given parent-substance. Metabolites can also be the degradation products of several parent-substances, and the parent-substances can be either one or several active substances and/or one or several metabolite. The only limitation is the total number of model run, which can not be higher than 998.</p>
<p>Also, it is possible to simulate different, unrelated, substances and scenario in the same batch of simulations.</p>
<div id="primary-metabolites-1st-order-metabolites" class="section level2">
<h2 class="hasAnchor">
<a href="#primary-metabolites-1st-order-metabolites" class="anchor"></a>Primary metabolites (1st order metabolites)</h2>
<p>The simulation of metabolites in MACRO In FOCUS is done in three steps.</p>
<ul>
<li><p>A simulation is run for the parent substance. It is not used for the metabolite, but provide output for the substance leaching to groundwater.</p></li>
<li><p>The very same simulation is run a second time, but with specific output variables: the mass of substance degraded for each time step and each numerical layer in the soil profiles. The output of that second run is called the “intermediate” output-file (or intermediate <code>.bin</code>-file).</p></li>
<li><p>A simulation is prepared for the metabolite. It uses the properties of the metabolite substance and a couple of other specific parameters indicating that what is simulated is a metabolite, not an active substance. Among other things, that simulation will use the the “intermediate” output-file to internally calculate the mass of metabolite formed at each time step and in each numerical layer in the soil profiles. This is done with a parameter called the “conversion factor” (mass of metabolite formed per mass unit of parent degraded).</p></li>
</ul>
<p>The conversion factor is equal to:</p>
<pre><code>(M_metabolite/M_parent)*formation_fraction</code></pre>
<p>where <code>M_metabolite</code> is the molar mass of the metabolite, <code>M_parent</code> is the molar mass of the parent and <code>formation_fraction</code> is the formation fraction of the metabolite (mol of metabolite formed per mol of parent degraded).</p>
<p>In <code>macrounchained</code>, and contrary to MACRO In FOCUS, the user indicates the formation fraction and the molar mass of the metabolite, as well as the molar mass of the parent, instead of giving directly the conversion factor. The conversion factor is calculated internally.</p>
</div>
<div id="nth-order-metabolites" class="section level2">
<h2 class="hasAnchor">
<a href="#nth-order-metabolites" class="anchor"></a>Nth order metabolites</h2>
<p>The case of Nth order metabolites (second order, third order, etc.) is the same as above, except that an “intermediate” simulation needs to be run for the “parent-metabolite” whose degradation produce a higher order metabolite.</p>
</div>
<div id="metabolites-formed-from-the-degradation-of-several-parent-substances" class="section level2">
<h2 class="hasAnchor">
<a href="#metabolites-formed-from-the-degradation-of-several-parent-substances" class="anchor"></a>Metabolites formed from the degradation of several parent-substances</h2>
<p>In the case of metabolites formed from the degradation of several parent-substances, things are handled differently from what is described above. In such a case, <code>macrounchained</code> is converting and merging the intermediate output files as follow:</p>
<ul>
<li><p>The intermediate output file of each parent is imported:</p></li>
<li><p>The intermediate output file of each parent is converted from “mass of parent-substance degraded at each time step and in each numerical layer” to “mass of metabolite formed from the degradation of the parent-substance at each time step and in each numerical layer”, using the “conversion factor” mentioned above.</p></li>
<li><p>All converted intermediate output files are merged (i.e.  “summed” time step for time step and numerical layer for numerical layer) into a single file that I call the “intermediate input file”. This file contains the “total mass of metabolite formed from the degradation of all its parent-substances at each time step and in each numerical layer”</p></li>
<li><p>This “intermediate input file” is used as a driving file for the simulation of the metabolite, exactly as if it was a standard, “intermediate output file”, except that the “conversion factor” of the simulation is set to 1 in the simulation’s parameter-file (as the conversion has already been done outside the model).</p></li>
</ul>
</div>
<div id="determining-the-order-of-the-simulations" class="section level2">
<h2 class="hasAnchor">
<a href="#determining-the-order-of-the-simulations" class="anchor"></a>Determining the order of the simulations</h2>
<p>In <code>macrounchained</code>, the user can provide parameters of each substance in any order. That is, it is possible that the row containing the parameters of the metabolite is before the row containing the parameter of its parent substance. Nonetheless, <code>macrounchained</code> is internally reordering the substances (and the simulations to be run) so that the simulation of parent-substances is performed before the simulation of their metabolites. This is done with an iterative process.</p>
<p>Also, the package will ‘group’ the simulation of substances that share the same active substance.</p>
</div>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>End-users should manually install the package from Windows binary package (a <code>.zip</code>-archive). The binary package provided on the website indicated below are presumably stable versions of the package, for release or pre-release (see status above).</p>
<p>Experienced users and developers may prefer to install the development version of the package, from <a href="https://github.com/" title="GitHub development platform">GitHub</a>. The later should not be seen as a stable version and may not work at all.</p>
<p>Before you install the package, check in the <a href="https://github.com/julienmoeys/macrounchained/blob/master/DESCRIPTION" title="macrounchained DESCRIPTION-file">DESCRIPTION</a>-file what is the minimum version of R needed to run this package (field “Depends”, see “R (&gt;= …)”). For convenience, the minimum R version required has been set to R &gt;= 3.1, so that user with an old version of R may still <em>try</em> to install and use the package. The package has nonetheless not been tested on that version, but instead on R 3.5.1 (at the time of writing this text). Some problems may therefore occur on older versions.</p>
<p>If needed, the code can be loaded as an R-script instead of installed as a package (see below), and used on any R-version presumably compatible with the code.</p>
<div id="installing-the-package-from-windows-binaries" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-the-package-from-windows-binaries" class="anchor"></a>Installing the package from Windows binaries</h2>
<p>Windows binary-installer (a <code>.zip</code> file) and source tar of the package (a <code>.tar.gz</code> file) can be downloaded from the following address: <a href="https://rpackages.julienmoeys.info/macrounchained/" class="uri">https://rpackages.julienmoeys.info/macrounchained/</a></p>
<p>Choose both the binary-installer for <code>macrounchained</code>, <code>rmacrolite</code>, <code>macroutils2</code> and <code>codeinfo</code>.</p>
<p>Save the files to a local folder on your computer.</p>
<p>As I cannot guarantee the integrity of the website above, it is recommended to scan the file(s) with an antivirus, not least if you work in a corporation or a public institution.</p>
<p>Do not unpack the <code>.zip</code> archive (nor the <code>.tar.gz</code> archive) before installing the package.</p>
<p>See also: <a href="https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Windows-packages" class="uri">https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Windows-packages</a></p>
<p><em>Method 1</em> (R graphical user interface for Windows):</p>
<p>Open R graphical user interface for Windows. Click on the ‘Packages’-menu and select ‘Install package(s) from local zip file…’. Select the package <code>.zip</code> binary package that you just downloaded, so that it is installed.</p>
<p>When done, type</p>
<pre><code>library("codeinfo)
library("macroutils2")
library("rmacrolite")
library("macrounchained")</code></pre>
<p>to check if the installation was successful.</p>
<p><em>Method 2</em> (install the zip binary package using the command line):</p>
<p>Open R command line prompt or R graphical user interface for Windows and type:</p>
<pre><code>install.packages( 
    pkgs = "C:/path/to/binary/file/codeinfo_x.y.z.zip", 
    repos = NULL ) 
install.packages( 
    pkgs = "C:/path/to/binary/file/macroutils2_x.y.z.zip", 
    repos = NULL ) 
install.packages( 
    pkgs = "C:/path/to/binary/file/rmacrolite_x.y.z.zip", 
    repos = NULL ) 
install.packages( 
    pkgs = "C:/path/to/binary/file/macrounchained_x.y.z.zip", 
    repos = NULL ) </code></pre>
<p>where <code>C:/path/to/binary/file/</code> should be replaced by the actual path to the folder where the binary package was downloaded and <code>codeinfo_x.y.z.zip</code>, <code>macroutils2_x.y.z.zip</code>, <code>rmacrolite_x.y.z.zip</code> and <code>macrounchained_x.y.z.zip</code> by the actual file-names (<code>x.y.z</code> being the version number, different for different packages). It is important to use a slash (<code>/</code>) as path separator, or alternatively a double backslash (<code>\\</code>), instead of a single backslash (<code>\</code>; Windows standard), as the later is a reserved character in R.</p>
<p><em>Method 3</em> (install the source package using the command line:</p>
<p>Open R command line prompt or R graphical user interface for Windows and type:</p>
<pre><code>install.packages( 
    pkgs = "C:/path/to/source/file/codeinfo_x.y.z.tar.gz", 
    repos = NULL, type = "source" ) 
install.packages( 
    pkgs = "C:/path/to/source/file/macroutils2_x.y.z.tar.gz", 
    repos = NULL, type = "source" ) 
install.packages( 
    pkgs = "C:/path/to/source/file/rmacrolite_x.y.z.tar.gz", 
    repos = NULL, type = "source" ) 
install.packages( 
    pkgs = "C:/path/to/source/file/macrounchained_x.y.z.tar.gz", 
    repos = NULL, type = "source" ) </code></pre>
<p>where <code>C:/path/to/source/file/</code> should be replaced by the actual path to the folder where the source package was downloaded and <code>codeinfo_x.y.z.tar.gz</code>, <code>macroutils2_x.y.z.tar.gz</code>, <code>rmacrolite_x.y.z.tar.gz</code> and <code>macrounchained_x.y.z.tar.gz</code> by the actual file-name (<code>x.y.z</code> being the version number). See above the remark on the path separator.</p>
</div>
<div id="installing-the-package-from-github" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-the-package-from-github" class="anchor"></a>Installing the package from GitHub</h2>
<p>This method is reserved for experienced R users and developers. If you don’t know what you are doing, choose one of the installation method above.</p>
<p>The development version of <code>macroutils2</code> is publicly available on <a href="https://github.com/" title="GitHub development platform">GitHub</a> (<a href="https://github.com/julienmoeys/macroutils2" title="R package macroutils2 (GitHub)">here</a>), as well as the development version of <code>rmacrolite</code> (<a href="https://github.com/julienmoeys/rmacrolite" title="R package rmacrolite (GitHub)">here</a>) and <code>codeinfo</code> (<a href="https://github.com/julienmoeys/codeinfo" title="R package codeinfo (GitHub)">here</a>),</p>
<p>to install the development version of the packages, you will need to install the package <a href="https://CRAN.R-project.org/package=devtools" title="R package devtools (CRAN)">devtools</a> first. It is available on CRAN and can be easily installed. Simply type <code><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages("devtools")</a></code> in R command prompt. See also the package <a href="https://cran.r-project.org/web/packages/devtools/readme/README.html">README</a> page.</p>
<p>You can then install the development version of <code>codeinfo</code>, <code>macroutils2</code> and <code>rmacrolite</code> by typing in R command prompt:</p>
<pre><code>devtools::install_github("julienmoeys/codeinfo")
devtools::install_github("julienmoeys/macroutils2")
devtools::install_github("julienmoeys/rmacrolite")
devtools::install_github("julienmoeys/macrounchained")</code></pre>
</div>
<div id="source-the-package-as-an-r-script-instead-of-installing-the-package" class="section level2">
<h2 class="hasAnchor">
<a href="#source-the-package-as-an-r-script-instead-of-installing-the-package" class="anchor"></a>Source the package as an R script instead of installing the package</h2>
<p>It is also possible to source the package as an R-script instead of installing the package. This method has some drawbacks (help pages not available; R workspace polluted with many objects otherwise invisible to end-users; sourced-code may be accidentally modified by the user; lack of traceability), but may be useful to some users, for example with restricted possibilities to install new R packages, as a <a href="https://en.wikipedia.org/wiki/Bootstrapping">bootstrap</a>.</p>
<p>First, open the following <code>.r</code>-file <a href="https://raw.githubusercontent.com/julienmoeys/macrounchained/master/R/macrounchained.r" class="uri">https://raw.githubusercontent.com/julienmoeys/macrounchained/master/R/macrounchained.r</a> and save it on your computer. This file contains the full R source code of the package.</p>
<p>Open R command line prompt or R graphical user interface for Windows and type:</p>
<pre><code>library("codeinfo") 
library("macroutils2") 
library("rmacrolite") 
source( "C:/path/to/file/macrounchained.r" ) </code></pre>
<p>where <code>C:/path/to/file/</code> should be replaced by the actual path to the folder where the file was downloaded. See above the remark on the path separator.</p>
</div>
<div id="tarexe-for-archiving-all-input-and-output-files" class="section level2">
<h2 class="hasAnchor">
<a href="#tarexe-for-archiving-all-input-and-output-files" class="anchor"></a>tar.exe for archiving all input and output files</h2>
<p><code><a href="reference/macrounchained-methods.html">macrounchained()</a></code> and <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code> rely on the executable <code>tar.exe</code> to produce an archive containing all the input and output files generated during the operations.</p>
<p><code>tar.exe</code> should be available on Windows 10 <a href="https://techcommunity.microsoft.com/t5/Containers/Tar-and-Curl-Come-to-Windows/ba-p/382409">from Build 17063</a>. If you have an older version of Windows, the archiving may not work (but <code><a href="reference/macrounchained-methods.html">macrounchained()</a></code> will not crash, just issue a warning). If you don’t know if <code>tar.exe</code> is installed on your computer, open Windows command prompt (<code>cmd.exe</code>) and type</p>
<pre><code>echo "%tar%"</code></pre>
<p>If the command returns <code>"%tar%"</code>, then no tar executable is defined in Windows Environment Variables. You can then type:</p>
<pre><code>where tar.exe</code></pre>
<p>If the command returns <code>INFO: Could not find files for the given pattern(s).</code>, then <code>tar.exe</code> cannot be found in Windows <code>PATH</code> environment variable.</p>
<p>If <code>tar.exe</code> is not installed on your computer and you need the archive functionality, contact your system administrator to find a solution.</p>
</div>
<div id="swedish-and-norwegian-macro-scenario" class="section level2">
<h2 class="hasAnchor">
<a href="#swedish-and-norwegian-macro-scenario" class="anchor"></a>Swedish and Norwegian MACRO scenario</h2>
<p>The five Swedish and Norwegian MACRO scenario (Krusenberg, Önnestad, Näsbygård, Heia and Rustad) require specific climate-files that are not delivered with MACRO In FOCUS. These files are not included either in <code>macrounchained</code>, and need to be obtained separately. See the Northern Zone Guidance Document for more information.</p>
<p>On the other hand, it is not necessary to have the Access database with the Norwegian MACRO scenario (Heia and Rustad), as their parameters are included in <code>macrounchained</code>. More generally, <code>macrounchained</code> does not make use of MACRO In FOCUS Access-files.</p>
</div>
</div>
<div id="benchmarks" class="section level1">
<h1 class="hasAnchor">
<a href="#benchmarks" class="anchor"></a>Benchmarks</h1>
<p>In order to make sure that the package results are conform to the output of MACRO In FOCUS 5.5.4 or MACRO 5.2, a number of benchmarks have been prepared. In these benchmarks, the output of <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code> is compared to the output of MACRO In FOCUS (PECgw and water percolation).</p>
<p>These benchmarks can be run at anytime, and also aim at detecting mistakes that could be introduced in the code when it is further developed (for maintenance or new features).</p>
<p>In some cases it is was not possible to compare the output of <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code> with MACRO In FOCUS (secondary metabolites, multiple transformation pathways), and the benchmarks is only used to detect accidental drift from the original output.</p>
<p>In these benchmarks, the parameter files (<code>.par</code>-files) produced by <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code> or <code><a href="reference/macrounchained-methods.html">macrounchained()</a></code> are compared to those produced by MACRO In FOCUS 5.5.4 or MACRO 5.2. Some differences in the parameter files have been noticed, that are thought to be without consequences on the output. The benchmark make sure there are no more differences than what is expected.</p>
<p>For reasons that are not completely clear, some small differences have been noted in the output files. They could be due to a difference in the preparation of the <code>indump.tmp</code>-file produced by MACRO In FOCUS 5.5.4 or MACRO 5.2 and that produced by the <code>exeparfile.exe</code>. Small differences may also be possible in the way the results are aggregated for each “period” (yearly flows when the pesticide is applied every year). In the benchmarks, the PECgw produced by <code><a href="reference/macrounchainedFocusGW-methods.html">macrounchainedFocusGW()</a></code> are the same as those produced by MACRO In FOCUS 5.5.4, when rounded to three significant figures, but a case has been observed where the third digit of the PECgw differed from that of MACRO In FOCUS 5.5.4. In the later case, it was observed that several years had very close yearly-average concentrations, resulting in a different ranking that that obtained by MACRO In FOCUS 5.5.4.</p>
<p>The benchmarks and their results are available here: <a href="https://github.com/julienmoeys/macrounchained/tree/master/inst/more_tests" class="uri">https://github.com/julienmoeys/macrounchained/tree/master/inst/more_tests</a></p>
<div id="official-focus-version-control" class="section level2">
<h2 class="hasAnchor">
<a href="#official-focus-version-control" class="anchor"></a>Official FOCUS “version control”</h2>
<ul>
<li><p>Châteaudun-scenario, winter cereals, application every year with substances “GW-A”, “GW-B”, “GW-C”, “Met_C” and “GW-D”. “Met_C” is a primary metabolite of “GW-C”. All these substances are so called FOCUS dummy substances.</p></li>
<li><p>Châteaudun-scenario, potatoes, application every third year with substance “GW-D”.</p></li>
</ul>
</div>
<div id="other-benchmarks" class="section level2">
<h2 class="hasAnchor">
<a href="#other-benchmarks" class="anchor"></a>Other benchmarks</h2>
<ul>
<li><p>Châteaudun-scenario, potatoes, application every second year with substance “GW-D”.</p></li>
<li><p>Châteaudun-scenario, winter cereals, two applications per year, every year, with substance “GW-A”.</p></li>
<li><p>Châteaudun-scenario, winter cereals, application every year with a new dummy substance, GW-M, a primary metabolite “Met-M1” and a secondary metabolite “Met-M2”.</p></li>
<li><p>The three Swedish scenario (non FOCUS), Krusenberg, Önnestad and Näsbygård, with spring oilseed rape, grass and pome/ stone fruits, respectively, and substances “GW-A”, “GW-B” and “GW-C”, respectively.</p></li>
<li><p>The two Norwegian scenario (non FOCUS), Rustad and Heia, with spring cereals and legumes, respectively, and substances “GW-A” and “GW-B”, respectively.</p></li>
<li><p>Default simulation in MACRO 5.2, two year simulations, with the default crop and an application every year. “GW-C” and “Met_C” were simulated, and their overall average leaching concentration was calculated. Notice that metabolites cannot be parametrised in MACRO 5.2, so the comparison only concerns the parent.</p></li>
<li><p>Châteaudun-scenario, spring cereals, application every year with two new dummy active substance, GW-M and GW-N (representing the hypothetical case of two active substances included in the same plant protection product). The degradation pathway can be virtualised here: <a href="https://github.com/julienmoeys/macrounchained/blob/master/inst/more_tests/test_GW_10_multiple-paths.svg" title="Figure illustrating multiple transformation pathways">inst/more_tests/test_GW_10_multiple-paths.svg</a>. GW-M has three metabolites, “Met-M0”, “Met-M1” and “Met-M2”, and GW-N has two metabolites, “Met-N1” and “Met-N2”. “Met-M2” and “Met-N2” are in fact the same substance, and is the degradation product of “GW-M”, “Met-M1” and “Met-N1”. The metabolite “Met-M1” is the degradation product of “GW-M” and “Met-M0”. “Met-M0” is the degradation product of “GW-M”, and “Met-N1” is the degradation product of “GW-N”.</p></li>
</ul>
</div>
</div>
<div id="release-history" class="section level1">
<h1 class="hasAnchor">
<a href="#release-history" class="anchor"></a>Release history</h1>
<p>Please check the <a href="https://github.com/julienmoeys/macrounchained/blob/master/README.md">online version of this page</a> to make sure the information is up to date, as the package will not include information on its own release.</p>
<p>For more information on the changes, see the <a href="https://github.com/julienmoeys/macrounchained/blob/master/NEWS" title="macrounchained NEWS-file">NEWS</a>-file for <code>macrounchained</code> and for its dependencies (<a href="https://github.com/julienmoeys/rmacrolite/blob/master/NEWS" title="rmacrolite NEWS-file">rmacrolite NEWS</a>, <a href="https://github.com/julienmoeys/macroutils2/blob/master/NEWS" title="macroutils2 NEWS-file">macroutils2 NEWS</a> and <a href="https://github.com/julienmoeys/codeinfo/blob/master/NEWS" title="codeinfo NEWS-file">codeinfo NEWS</a>).</p>
<p><em>2019-05 (release 2):</em></p>
<p>New versions of <code>macrounchained</code> and <code>codeinfo</code></p>
<pre><code>1 macrounchained  0.13.0  93b0f40    2019-05-26
2     rmacrolite   0.9.7  9a38321    2019-04-15
3    macroutils2   2.2.3  ef26fd7    2019-04-17
4       codeinfo   0.1.3  a595b27    2019-05-13</code></pre>
<p><em>2019-04 (release 1):</em></p>
<pre><code>         package version revision date_packaged
1 macrounchained  0.11.2  1fc0b86    2019-04-18
2     rmacrolite   0.9.7  9a38321    2019-04-15
3    macroutils2   2.2.3  ef26fd7    2019-04-17
4       codeinfo   0.1.2  c91f2f2    2019-04-17</code></pre>
</div>
<div id="about" class="section level1">
<h1 class="hasAnchor">
<a href="#about" class="anchor"></a>About</h1>
<p>This package is a personal project of the author. It is not funded or supported by any corporation or public body.</p>
<div id="report-issues" class="section level2">
<h2 class="hasAnchor">
<a href="#report-issues" class="anchor"></a>Report issues</h2>
<p>Your are very welcome to report any (suspected) error or issue on this page: <a href="https://github.com/julienmoeys/macrounchained/issues" class="uri">https://github.com/julienmoeys/macrounchained/issues</a></p>
<p>Before reporting on this page, try to reproduce the issue on a generic example that you can provide together with your issue.</p>
</div>
<div id="user-support" class="section level2">
<h2 class="hasAnchor">
<a href="#user-support" class="anchor"></a>User Support</h2>
<p>Currently, I cannot provide user-support for this tool. In my experience, many questions are general R questions rather than questions specific to my R packages, so it may help to get support from an experienced R programmer.</p>
</div>
<div id="disclaimer" class="section level2">
<h2 class="hasAnchor">
<a href="#disclaimer" class="anchor"></a>Disclaimer</h2>
<p>This tool is <strong>not an official or officious regulatory tool</strong>.</p>
<p>It is <strong>not endorsed</strong> by <a href="https://esdac.jrc.ec.europa.eu/projects/focus-dg-sante" title="FOrum for the Co-ordination of pesticide fate models and their USe">FOCUS DG SANTE</a>, <a href="https://www.slu.se/ckb" title="Centre for Chemical Pesticides (CKB)">SLU/CKB</a> or the author’s <a href="https://www.kemi.se/en" title="Swedish Chemicals Agency">employer</a>.</p>
<p>It does not engage these institutions nor reflects any official position on regulatory exposure assessment.</p>
<p>Indeed, the website of <a href="https://esdac.jrc.ec.europa.eu/projects/focus-dg-sante" title="FOrum for the Co-ordination of pesticide fate models and their USe">FOCUS DG SANTE</a> “<em>is the one and only definitive source of the currently approved version of the FOCUS scenarios and associated models and input files.</em>”. Thus, please refer to <a href="https://esdac.jrc.ec.europa.eu/projects/focus-dg-sante" title="FOrum for the Co-ordination of pesticide fate models and their USe">FOCUS DG SANTE</a> or to the competent authorities in each EU regulatory zone for guidance on officially accepted tools and methods.</p>
<p>As stated in the <a href="https://github.com/julienmoeys/macrounchained/blob/master/LICENSE" title="macrounchained LICENSE-file">LICENSE</a>, the package is provided <strong>without any warranty</strong>.</p>
<!-- LIST OF LINKS -->
</div>
</div>

  </div>

  <div class="col-md-3" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/julienmoeys/macrounchained">https://​github.com/​julienmoeys/​macrounchained</a>
</li>
<li>Report a bug at <br><a href="https://github.com/julienmoeys/macrounchained/issues">https://​github.com/​julienmoeys/​macrounchained/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Julien Moeys <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Julien Moeys.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
